---
date: "2011-01-07T20:32:45Z"
tags:
- Android
- Mobile Dev
title: '[Android][Dev tip] 在手機畫面上加上一個浮水印'
tumblr_url: http://blog.jln.co/post/2636164604/androiddev-tip-在手機畫面上加上一個浮水印
---
<div class="posterous_autopost"><p>其實這是一個沒啥用的技巧（至少我還想不出應用）, 就是加上一個像是浮水印的東西在畫面上, 不管在哪都會出現的, 像是這樣:</p>  <p><img src="http://posterous.com/getfile/files.posterous.com/temp-2011-01-07/xncheEwklHDpaebkmswmhzddFAirDfiIyIeJpeCzADvttFwlcunfcetqEJzr/ova1.png.scaled500.png" width="480" height="800"/><img src="http://posterous.com/getfile/files.posterous.com/temp-2011-01-07/FgtouerECIfvBFrGeorctwbJDykaDEqFDDqxamtvcmthjgdzxAkECstjaofg/ova2.png.scaled500.png" width="480" height="800"/> 因為這個image要讓他一直不會消失, 所以他並不會是一個Activity, 因為Activity會有他的生命週期, 離開後就沒了, 所以要透過WindowManager去加上這個ImageView, 而且加上View的動作必須要給Background service去處理(這樣也就可以去做一些變化, 或動畫之類的)</p>  <p>首先, 要建立一個Service, 要達成這目的也很簡單, 在onCreate加上:</p>  <blockquote>  <p><span style=""> </span>WindowManager wm = (WindowManager) this</p>  <p><span style=""> </span>.getSystemService(Service.WINDOW_SERVICE);</p>    <p><span style=""> </span>ImageView logo = new ImageView(this);</p>  <p><span style=""> </span>logo.setImageResource(R.drawable.onepieceoverlay);</p>  <p><span style=""> </span>WindowManager.LayoutParams lparam = new WindowManager.LayoutParams(</p>  <p><span style=""> </span>WindowManager.LayoutParams.WRAP_CONTENT,</p>  <p><span style=""> </span>WindowManager.LayoutParams.WRAP_CONTENT,</p>  <p><span style=""> </span>WindowManager.LayoutParams.TYPE_SYSTEM_OVERLAY, 0, PixelFormat.TRANSLUCENT);</p>  <p><span style=""> </span>lparam.gravity = Gravity.RIGHT | Gravity.TOP;</p>  <p><span style=""> </span>wm.addView(logo, lparam);</p>    </blockquote>  <p>這樣就好了, 其實很簡單, 就是透過WindowManager在system overlay上加個view</p>  <p>但這樣還不會work, 因為少了一個permission, 所以必須在AndroidManifest裡面加上</p>  <blockquote class="posterous_short_quote">  <p>&lt;uses-permission android:name=&ldquo;android.permission.SYSTEM_ALERT_WINDOW&rdquo;&gt;&lt;/uses-permission&gt;</p>  </blockquote>  <p>這樣就好了</p>  <p>不過system overlay沒辦法接touch event, 所以這邊放的view真的只是拿來放好看的</p></div>
