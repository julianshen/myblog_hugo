---
date: "2012-05-08T02:47:37Z"
tags:
- b2g
- HTML5
- Mobile Dev
- Web Dev
title: '[筆記] Self published B2G app'
tumblr_url: http://blog.jln.co/post/22597582499/筆記-self-published-b2g-app
---
<div class="posterous_autopost"><p>B2G並未一定要開發者把應用程式發表到一個特別的app store, 網站也可以自行加一個install按鍵, 讓使用者把你的網站當應用程式裝到手機內</p>  <p>首先, 你必須要先有個manifest, 目前manifest並沒強制的檔名, 但文件裡建議叫 xxxx.webapp, 以下是範例內容:</p>  <blockquote>    <div class="CodeRay"> <div class="code"><pre>{ "name": "MyTestApp", "description": "test app", "launch_path": "/", "icons": { "128": "/img/icon.png" }, "developer": { "name": "Julian Shen" } }</pre></div> </div>   <p> </p>  </blockquote>  <p>然後在網頁內加上檢查是否安裝, 以及安裝的程式碼, 範例如下:</p>  <blockquote>  <div class="CodeRay"> <div class="code"><pre>var manifestUrl = 'http://localhost:3000/manifest.webapp'; var app = navigator.mozApps;  function checkInstalled() { var request = app.getSelf(); request.onsuccess = function() { if(request.result) { //installed console.log('installed'); document.getElementById('installmsg').style.display='none'; } else { //not installed console.log('not installed'); } }; }  function install(cb) { var request = app.install(manifestUrl); request.onsuccess = function() { alert('installed'); };  request. function() { alert('Not installed'); } }</pre></div> </div>   <div class="CodeRay"> <div class="code"><pre></pre></div> </div>   </blockquote>  <div class="CodeRay"> <div class="code"><pre>這邊要注意的是manifestUrl必須是full path而不是只有相對位置, 寫相對位置, 它還是讀的到, 但會出parse error, 之前害我搞半天一直以為是格式問題, trace了一下Webapps.js, 發現可能是判斷install origin有問題</pre></div> </div>   <div class="CodeRay"> <div class="code"><pre>目前安裝介面很醜:</pre></div> </div>   <div class="CodeRay"> <div class="code"><pre><div class="p_embed p_image_embed"> <img alt="_2012-05-08_2" height="750" src="http://getfile1.posterous.com/getfile/files.posterous.com/temp-2012-05-07/ooihkDHBpywonfhojaAcdErhAkrtxFGhBqdpjkkHCkzwsumiaffekgqCquag/_2012-05-08_2.19.34.png.scaled500.png" width="480"/></div> </pre></div> </div>   <div class="CodeRay"> <div class="code"><pre>安裝完就可以在Home screen看到它的存在了:</pre></div> </div>   <div class="CodeRay"> <div class="code"><pre><div class="p_embed p_image_embed"> <img alt="_2012-05-08_2" height="654" src="http://getfile9.posterous.com/getfile/files.posterous.com/temp-2012-05-07/IJiheCGjzyIaelczhvgxorgBGyciodoGxCHinExhzpbJGurzadiDqwAJkcgu/_2012-05-08_2.23.43.png.scaled500.png" width="452"/></div> </pre></div> </div></div>
